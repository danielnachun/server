create or replace table t1 (x int)
partition by range(x) (
partition p1 values less than (10),
partition p2 values less than (20),
partition p3 values less than (30),
partition p4 values less than (40),
partition p5 values less than (50),
partition pn values less than maxvalue);
select partition_name, subpartition_name
from information_schema.partitions
where table_name = 't1';
partition_name	subpartition_name
p1	NULL
p2	NULL
p3	NULL
p4	NULL
p5	NULL
pn	NULL
insert into t1 values (2), (12), (22), (32), (42), (52);
create or replace table tp2 (y int);
insert tp2 values (88);
alter table t1 extract partition p2 as table tp2, drop partition p3;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ' drop partition p3' at line 1
alter table t1 extract partition p00 as table tp00;
ERROR HY000: Error in list of partitions to DROP
alter table t1 extract partition p00 as table tp2;
ERROR 42S01: Table 'tp2' already exists
alter table t1 extract partition p2 as table tp2;
ERROR 42S01: Table 'tp2' already exists
select * from tp2;
y
88
drop table tp2;
alter table t1 extract partition p2 as table tp2;
show create table tp2;
Table	Create Table
tp2	CREATE TABLE `tp2` (
  `x` int(11) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
select * from tp2;
x
12
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
 PARTITION BY RANGE (`x`)
(PARTITION `p1` VALUES LESS THAN (10) ENGINE = MyISAM,
 PARTITION `p3` VALUES LESS THAN (30) ENGINE = MyISAM,
 PARTITION `p4` VALUES LESS THAN (40) ENGINE = MyISAM,
 PARTITION `p5` VALUES LESS THAN (50) ENGINE = MyISAM,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = MyISAM)
select * from t1 order by x;
x
2
22
32
42
52
alter table t1 extract partition p3 as table inexistent.tp3;
ERROR 42000: Unknown database 'inexistent'
create database EXISTENT;
alter table t1 extract partition p3 as table EXISTENT.TP3;
show create table EXISTENT.TP3;
Table	Create Table
TP3	CREATE TABLE `TP3` (
  `x` int(11) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
select * from EXISTENT.TP3 order by x;
x
22
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `x` int(11) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
 PARTITION BY RANGE (`x`)
(PARTITION `p1` VALUES LESS THAN (10) ENGINE = MyISAM,
 PARTITION `p4` VALUES LESS THAN (40) ENGINE = MyISAM,
 PARTITION `p5` VALUES LESS THAN (50) ENGINE = MyISAM,
 PARTITION `pn` VALUES LESS THAN MAXVALUE ENGINE = MyISAM)
select * from t1 order by x;
x
2
32
42
52
drop database EXISTENT;
drop tables t1, tp2;
